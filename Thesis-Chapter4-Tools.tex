\chapter{Analysis Tools}
\label{chap-tools}

Encryption policy arguments and \acl{EA} threat models are complex. \Acp{argmap} and \aclp{DFD} are two methodological
tools that can be used to structure analysis and manage complexity. This chapter introduces these tools and their
syntax, which will be used in \mychap{chap-arguments} and \mychap{chap-threatmodel}.


\section{Argument Maps}
\label{sec-arg-maps-intro}

In order to advance the \ac{EA} discussion, it is necessary to organize the many different arguments in a cohesive
manner. This thesis uses \acp{argmap} to do so. \Acp{argmap} are graphical representations of the logical structures and
relationships between statements, premises, and conclusions. They originated from the same research as the idea of
\acp{wicked-prob}. Though formal research on the technique is sparse, \acp{argmap} have proven helpful in simplifying
complex arguments regarding \acp{wicked-prob} \cite{renton_2007} and in facilitating debate. This is because they slow
down discussion, depersonalize conflict, and lend structure and rhythm to meetings \cite{dutoit_hypermedia_2006}. They
are therefore useful as a tool for conducting the \ac{OODAloop} model's ``collaborative debate'' step.

% TODO: can probably cut more
Argument mapping tools originated in 1970 with text-based \acp{IBIS} \cite{kunz_issues_1970}. Interest in \acp{IBIS} has
waxed and waned. Some software tools have been developed, including the now-defunct gIBIS \cite{conklin_gibis_1988} and
Compendium \cite{dutoit_hypermedia_2006}, which were designed to produce graphical argument representations. Argdown is
a recent tool that generates graphical \acp{argmap} from structures specified in a Markdown-based language
\cite{voigt_argdown_2018}. Argdown is used in \mychap{chap-arguments} to analyze the arguments used in the \ac{EA}
debate.

\myfig{fig-args-key} shows the basic structure of arguments. Statements can take the form of positions, values, and
assertions. The ``Proposals,'' ``Statements,'' ``Fallacies,'' and ``Values'' in the figure are classes of statements in
this sense. The color of a statement's border indicates the class to which it belongs. Arguments are premise-conclusion
structures that relate to statements; they are classified as ``anti-EA,'' ``pro-EA,'' ``neutral,'' or ``fallacious.'' An
argument's class is distinguished by the color of its solid background. Statements and arguments may support, attack, or
undercut one another. Green arrows represent supporting relationships; red arrows, attacking; and purple arrows,
undercutting.

\begin{figure}[h]
    \centering\CaptionFontSize
    \myincludeargument{key}
    \caption{A demonstrative example of argument maps with Argdown}
    \label{fig-args-key}
\end{figure}


\section{Threat Modeling with Data Flow Diagrams}
\label{sec-threat-model-intro}

Threat modeling is an important step in analyzing the security at the systems level. Models abstract away fine details
and focus on the architecture, processes, and dataflows in a system. They assist in the understanding of current systems
and the prevention of problems in new systems, both of which are important when facing the prospect of designing an
\ac{EA} mechanism built on top of a complex and aging technology stack.

Threat modeling begins with the questions, ``What are you building?'' and ``What can go wrong?''
\cite{shostack_threat_2014}. Accurately answering the first question is crucial, particularly for the field of
cryptography, which hinges on precise definitions of security requirements \cite{varia_2018}. The answer to the second
question depends on the types of attackers under consideration and determines the scope of threats to be considered.
``What are you building?'' hasn't been asked enough in the current phase of the \ac{EA} debate, and ``What can go
wrong?'' cannot be faithfully answered without knowing what is being built.

\Acp{DFD} were designed to address these questions. \Acp{DFD} feature processes, data flows, data stores, and external
entities. \Acp{DFD} are well-suited for threat modeling because security vulnerabilities tend to follow data flow, not
control flow \cite{shostack_threat_2014}. They are particularly well-suited for \ac{EA}, as data privacy is of primary
concern. \myfig{fig-dfd-dh-traditional} shows the basic elements of a \ac{DFD} of a simplified Diffie-Hellman key
exchange.

\begin{figure}[h]
    \centering\CaptionFontSize
    \includegraphics[width=0.8\linewidth]{dfds/build/diffie-hellman-traditional.png}
    \caption{A \acf{DFD} for a simplified Diffie-Hellman key exchange}
    \label{fig-dfd-dh-traditional}
\end{figure}

\Acp{DFD} show what data is transferred via labels on the flows. However, labels can be insufficient in complex
\acp{DFD}, and the method has no syntax for computation or cryptographic protocols. In order to maximize their
communicative ability in the context of encryption and \acl{EA} schemes, I introduce the additional syntax show in
\myfig{fig-dfd-dh-updated}.

\begin{figure}[h]
    \centering\CaptionFontSize
    \includegraphics[width=\linewidth]{dfds/build/diffie-hellman.png}
    \caption{A Diffie-Hellman key exchange illustrated with additional syntax}
    \label{fig-dfd-dh-updated}
\end{figure}

The new syntax illustrates the data in more detail as it is stored, transferred, and operated on. By illustrating the
data itself, it eliminates the need for labels on lines and can be used to communicate entire protocols in a single
diagram. \myfig{fig-dfd-key} contains the full set of symbols. \mychap{chap-threatmodel} includes \acp{DFD} in this
style to analyze threats that EA would introduce.

\begin{figure}[t]
    \centering\CaptionFontSize
    \includegraphics[width=0.85\linewidth]{dfds/build/dfd-key.png}
    \caption{Expanded set of DFD symbols}
    \label{fig-dfd-key}
\end{figure}
